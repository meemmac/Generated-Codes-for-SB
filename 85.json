{
"title": "Persistent Segment Tree",
"subtitle": "Segment tree that maintains previous versions after updates",
"time_complexity": "O(log N) per update/query",
"space_complexity": "O(N log N) for all versions",
"category": "Data Structure / Segment Tree",
"code": [
    "class Node:",
    "    def __init__(self, val=0, left=None, right=None):",
    "        self.val = val",
    "        self.left = left",
    "        self.right = right",
    "def build(arr, l, r):",
    "    if l == r:",
    "        return Node(arr[l])",
    "    mid = (l + r) // 2",
    "    left = build(arr, l, mid)",
    "    right = build(arr, mid+1, r)",
    "    return Node(left.val + right.val, left, right)",
    "def update(prev, l, r, idx, value):",
    "    if l == r:",
    "        return Node(value)",
    "    mid = (l + r) // 2",
    "    if idx <= mid:",
    "        left = update(prev.left, l, mid, idx, value)",
    "        return Node(left.val + prev.right.val, left, prev.right)",
    "    else:",
    "        right = update(prev.right, mid+1, r, idx, value)",
    "        return Node(prev.left.val + right.val, prev.left, right)",
    "def query(node, l, r, ql, qr):",
    "    if ql > r or qr < l:",
    "        return 0",
    "    if ql <= l and r <= qr:",
    "        return node.val",
    "    mid = (l + r) // 2",
    "    return query(node.left, l, mid, ql, qr) + query(node.right, mid+1, r, ql, qr)"
],
"additional_information": "Persistent segment trees allow queries on previous versions after updates. Each update creates a new version, preserving older states."
}
