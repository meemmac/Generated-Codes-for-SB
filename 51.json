{
"title": "Ahoâ€“Corasick Automaton",
"subtitle": "Multi-pattern string matching in O(text_length + total_pattern_length + matches)",
"time_complexity": "O(N + M + Z) where N=text length, M=sum pattern lengths, Z=matches",
"space_complexity": "O(M * alphabet) (trie size)",
"category": "String Algorithms / Automata",
"code": [
    "from collections import deque",
    "class AhoCorasick:",
    "    def __init__(self):",
    "        self.next = [{}]",
    "        self.fail = [0]",
    "        self.out = [[]]",
    "    def add(self, word, idx):",
    "        node = 0",
    "        for ch in word:",
    "            if ch not in self.next[node]:",
    "                self.next[node][ch] = len(self.next)",
    "                self.next.append({})",
    "                self.fail.append(0)",
    "                self.out.append([])",
    "            node = self.next[node][ch]",
    "        self.out[node].append(idx)",
    "    def build(self):",
    "        q = deque()",
    "        for ch, v in self.next[0].items():",
    "            q.append(v)",
    "            self.fail[v] = 0",
    "        while q:",
    "            r = q.popleft()",
    "            for ch, s in self.next[r].items():",
    "                q.append(s)",
    "                f = self.fail[r]",
    "                while f and ch not in self.next[f]:",
    "                    f = self.fail[f]",
    "                self.fail[s] = self.next[f].get(ch, 0)",
    "                self.out[s] += self.out[self.fail[s]]",
    "    def search(self, text):",
    "        node = 0",
    "        results = []",
    "        for i, ch in enumerate(text):",
    "            while node and ch not in self.next[node]:",
    "                node = self.fail[node]",
    "            node = self.next[node].get(ch, 0)",
    "            for pat_idx in self.out[node]:",
    "                results.append((i, pat_idx))",
    "        return results"
],
"additional_information": "Build a trie of patterns, compute failure links (like KMP), then scan text once to report all pattern occurrences."
}
